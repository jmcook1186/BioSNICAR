function [Re Im] = refracICE(WL)

% Returns the wavelength dependent complex index of refration for ice. 
% Allowable wavelength range: 0.0443 - 2E+06 microns
%
% Interpolation is done by:
%   Re  VS. LOG(WL)
%   LOG(Im) VS. LOG(WL)
%
% Written by:
%   ALEX GARDNER - 2008
%   UNIVERSITY OF ALBERTA
%   DEPT. OF EARTH & ATMOSPHERIC SCIENCES
%   EDMONTON, AB, CANADA
%
% Based on:
%   Reference: Warren, S.G. and R.E. Brandt, 2008: Optical constants of ice
%   from the ultraviolet to the microwave: a revised compilation. In press 
%   at J. Geophys. Res.
%
% Input parameters:
%   WL = = wavelength ( microns)
%   T = Temperature ( degree K )
%
% Output parameters:
%   Re = REAL PORTION ( SCATTERING )
%   Im = IMAGINARY PORTION ( ABSORPTION )

%% Look up function
% define variables
 WLMIN = 0.0443;
 WLMAX= 2E6;

% check wavelenth within limits
if (WL > WLMAX) ||(WL < WLMIN)
    error('wavelength out of range (0.0443 - 2E+06 microns')
end

 % Define optical properties
 WL0 = [ 0.0443 0.0451 0.0459 0.0468 0.0477 0.0486 0.0496 0.0506 0.0517 ...
     0.0528 0.0539 0.0551 0.0564 0.0577 0.0590 0.0605 0.0620 0.0636 ...
     0.0653 0.0670 0.0689 0.0708 0.0729 0.0738 0.0751 0.0775 0.0800 ...
     0.0827 0.0855 0.0886 0.0918 0.0930 0.0954 0.0992 0.1033 0.1078 ...
     0.110 0.1127 0.114 0.1181 0.121 0.124 0.1272 0.1295 0.1305 0.1319 ...
     0.1333 0.1348 0.1362 0.137 0.1378 0.1387 0.1393 0.1409 0.1425 ...
     0.1435 0.1442 0.145 0.1459 0.1468 0.1476 0.148 0.1485 0.1494 ...
     0.1512 0.1531 0.154 0.155 0.1569 0.158 0.1589 0.161 0.163 0.165 ...
     0.167 0.169 0.171 0.173 0.175 0.177 0.179 0.181 0.183 0.185 0.187 ...
     0.189 0.191 0.193 0.195 0.197 0.199 0.201 0.2019 0.210 0.250 0.300 ...
     0.350 0.390 0.400 0.410 0.420 0.430 0.440 0.450 0.460 0.470 0.480 ...
     0.490 0.500 0.510 0.520 0.530 0.540 0.550 0.560 0.570 0.580 0.590 ...
     0.600 0.610 0.620 0.630 0.640 0.650 0.660 0.670 0.680 0.690 0.700 ...
     0.710 0.720 0.730 0.740 0.750 0.760 0.770 0.780 0.790 0.800 0.810 ...
     0.820 0.830 0.840 0.850 0.860 0.870 0.880 0.890 0.900 0.910 0.920 ...
     0.930 0.940 0.950 0.960 0.970 0.980 0.990 1 1.01 1.02 1.03 1.04 ...
     1.05 1.06 1.07 1.08 1.09 1.10 1.11 1.12 1.13 1.14 1.15 1.16 1.17 ...
     1.18 1.19 1.20 1.21 1.22 1.23 1.24 1.25 1.26 1.27 1.28 1.29 1.30 ...
     1.31 1.32 1.33 1.34 1.35 1.36 1.37 1.38 1.39 1.40 1.41 1.42 1.43 ...
     1.44 1.449 1.46 1.471 1.481 1.493 1.504 1.515 1.527 1.538 1.563 ...
     1.587 1.613 1.65 1.68 1.70 1.73 1.76 1.80 1.83 1.84 1.85 1.855 ...
     1.86 1.87 1.89 1.905 1.923 1.942 1.961 1.98 2 2.02 2.041 2.062 ...
     2.083 2.105 2.13 2.15 2.17 2.19 2.22 2.24 2.245 2.25 2.26 2.27 ...
     2.29 2.31 2.33 2.35 2.37 2.39 2.41 2.43 2.46 2.50 2.52 2.55 2.565 ...
     2.58 2.59 2.60 2.62 2.675 2.725 2.778 2.817 2.833 2.849 2.865 ...
     2.882 2.899 2.915 2.933 2.95 2.967 2.985 3.003 3.021 3.04 3.058 ...
     3.077 3.096 3.115 3.135 3.155 3.175 3.195 3.215 3.236 3.257 3.279 ...
     3.30 3.322 3.345 3.367 3.39 3.413 3.436 3.46 3.484 3.509 3.534 ...
     3.559 3.624 3.732 3.775 3.847 3.969 4.099 4.239 4.348 4.387 4.444 ...
     4.505 4.547 4.56 4.58 4.719 4.904 5 5.10 5.20 5.263 5.40 5.556 ...
     5.714 5.747 5.78 5.814 5.848 5.882 6.061 6.135 6.25 6.289 6.329 ...
     6.369 6.41 6.452 6.494 6.579 6.667 6.757 6.897 7.042 7.143 7.246 ...
     7.353 7.463 7.576 7.692 7.812 7.937 8.065 8.197 8.333 8.475 8.696 ...
     8.929 9.091 9.259 9.524 9.804 10 10.2 10.31 10.42 10.53 10.64 ...
     10.75 10.87 11 11.11 11.36 11.63 11.9 12.2 12.5 12.82 12.99 13.16 ...
     13.33 13.51 13.7 13.89 14.08 14.29 14.71 15.15 15.38 15.63 16.13 ...
     16.39 16.67 16.95 17.24 18.18 18.32 18.61 18.87 19.23 19.61 20 ...
     20.41 20.83 22.22 22.6 23.05 23.6 24.6 25 26 28.57 31 33.33 34.48 ...
     35.64 37 38.24 39.6 41.14 42.76 43.58 44.58 45.5 46.15 46.71 ...
     47.36 48 48.78 50.03 51.28 52.75 53.5 54.24 55 55.74 56.4 57 57.46 ...
     58.4 59.29 60 61 61.25 62.5 63.78 64.67 65.58 66.55 67.6 69 70.53 ...
     73 75 76.29 80 82.97 85 86.8 90.8 95.17 100 120 160 210 300 500 ...
     1300 5000 19000 39000 61000 86000 110000 140000 180000 240000 ...
     340000 540000 1000000 2000000];
 
 Re0 = [0.8228 0.825 0.8255 0.8258 0.8263 0.8281 0.8347 0.8428 0.8483 ...
     0.8505 0.8497 0.8489 0.8519 0.8566 0.8647 0.8797 0.897 0.9173 ...
     0.94 0.9679 1.0093 1.0536 1.0986 1.1183 1.1449 1.1885 1.2273 ... 
     1.2629 1.3117 1.3807 1.4091 1.4028 1.3948 1.3964 1.4047 1.3981 ... 
     1.3886 1.3806 1.3772 1.3783 1.3929 1.4061 1.3999 1.3777 1.3607 ... 
     1.3389 1.321 1.303 1.2871 1.2849 1.2851 1.297 1.3151 1.3575 1.413 ... 
     1.4525 1.4845 1.5157 1.5484 1.5729 1.5915 1.6021 1.6077 1.6156 ... 
     1.622 1.6311 1.6345 1.6363 1.6353 1.6309 1.6214 1.5818 1.5482 ... 
     1.5225 1.5027 1.487 1.4743 1.4635 1.4543 1.4462 1.439 1.4326 ... 
     1.4268 1.4215 1.4167 1.4122 1.4081 1.4043 1.4007 1.3974 1.3943 ... 
     1.3914 1.3901 1.3801 1.3509 1.3339 1.3249 1.3203 1.3194 1.3185 ... 
     1.3177 1.317 1.3163 1.3157 1.3151 1.3145 1.314 1.3135 1.313 ... 
     1.3126 1.3121 1.3117 1.3114 1.311 1.3106 1.3103 1.31 1.3097 ... 
     1.3094 1.3091 1.3088 1.3085 1.3083 1.308 1.3078 1.3076 1.3073 ... 
     1.3071 1.3069 1.3067 1.3065 1.3062 1.306 1.3059 1.3057 1.3055 ... 
     1.3053 1.3051 1.3049 1.3047 1.3046 1.3044 1.3042 1.304 1.3039 ... 
     1.3037 1.3035 1.3033 1.3032 1.303 1.3028 1.3027 1.3025 1.3023 ... 
     1.3022 1.302 1.3019 1.3017 1.3015 1.3014 1.3012 1.301 1.3009 ... 
     1.3007 1.3005 1.3003 1.3002 1.3  1.2998 1.2997 1.2995 1.2993 ... 
     1.2991 1.299 1.2988 1.2986 1.2984 1.2982 1.298 1.2979 1.2977 ... 
     1.2975 1.2973 1.2971 1.2969 1.2967 1.2965 1.2963 1.2961 1.2959 ... 
     1.2957 1.2955 1.2953 1.2951 1.2949 1.2946 1.2944 1.2941 1.2939 ... 
     1.2937 1.2934 1.2931 1.2929 1.2927 1.2924 1.2921 1.292 1.2918 ... 
     1.2916 1.2914 1.2912 1.2909 1.2903 1.2897 1.289 1.2879 1.287 ... 
     1.2863 1.2853 1.2843 1.2828 1.2816 1.2811 1.2807 1.2805 1.2802 ... 
     1.2797 1.2788 1.278 1.2771 1.2762 1.2756 1.275 1.2744 1.2736 ... 
     1.2728 1.2718 1.2707 1.2694 1.2677 1.2663 1.2648 1.2633 1.2609 ... 
     1.2591 1.2587 1.2582 1.2573 1.2564 1.2545 1.2525 1.2504 1.2482 ... 
     1.2459 1.2435 1.2409 1.2382 1.2337 1.227 1.2232 1.2169 1.2135 ... 
     1.2097 1.2071 1.2043 1.1983 1.1776 1.1507 1.1083 1.0657 1.0453 ... 
     1.0236 1.0001 0.9747 0.9563 0.9538 0.9678 0.9873 1.0026 1.018 ... 
     1.039 1.0722 1.1259 1.2089 1.3215 1.4225 1.4933 1.5478 1.597 ... 
     1.6336 1.6477 1.6405 1.6248 1.6108 1.5905 1.5714 1.5559 1.5396 ... 
     1.5241 1.5086 1.4949 1.4827 1.471 1.4604 1.4502 1.4411 1.4328 ... 
     1.4146 1.3924 1.385 1.375 1.3623 1.3526 1.3447 1.3406 1.3401 ... 
     1.3412 1.3444 1.3473 1.3482 1.3491 1.347 1.3379 1.3325 1.3268 ... 
     1.3212 1.3176 1.31 1.3013 1.2933 1.2917 1.2906 1.2902 1.2904 ... 
     1.2915 1.3015 1.3083 1.3152 1.3167 1.3178 1.3187 1.3194 1.3201 ... 
     1.3207 1.3214 1.3219 1.3229 1.3242 1.3244 1.3236 1.3229 1.3218 ... 
     1.32 1.3183 1.3158 1.3123 1.3086 1.3047 1.3007 1.2964 1.2917 ... 
     1.2835 1.2735 1.2655 1.2561 1.2387 1.2151 1.1926 1.1659 1.1501 ... 
     1.1323 1.1136 1.0971 1.0867 1.0833 1.0886 1.1023 1.1439 1.1983 ... 
     1.2546 1.3194 1.3822 1.4412 1.4683 1.4928 1.5132 1.53 1.5458 ... 
     1.5596 1.5701 1.5775 1.5762 1.5637 1.5559 1.5481 1.5353 1.5302 ... 
     1.5294 1.5306 1.5303 1.5141 1.5104 1.5043 1.4982 1.4939 1.4963 ... 
     1.4986 1.4956 1.4877 1.4575 1.4486 1.439 1.4282 1.4102 1.403 ... 
     1.3854 1.3404 1.2969 1.2641 1.253 1.2445 1.2371 1.2317 1.2243 ... 
     1.2054 1.1742 1.1549 1.1496 1.1853 1.2543 1.3474 1.4725 1.5874 ... 
     1.6841 1.7505 1.7649 1.7668 1.7687 1.7792 1.7955 1.8052 1.8041 ...
     1.794 1.7805 1.741 1.693 1.661 1.6419 1.6396 1.6372 1.6471 1.6596 ...
     1.6754 1.6945 1.7167 1.7466 1.778 1.8185 1.8419 1.8504 1.8617 ...
     1.8669 1.8688 1.8699 1.8698 1.8681 1.8654 1.8499 1.8268 1.8114 ...
     1.7989 1.7908 1.7868 1.7861 1.7861 1.7861 1.7861 1.7861 1.7861 ...
     1.7861 1.7861 1.7861 1.7861 1.7861 1.7861 1.786];
 
 Im0 = [0.164 0.173 0.183 0.195 0.208 0.223 0.24 0.25 0.259 0.268 0.279 ...
     0.297 0.319 0.34 0.366 0.392 0.416 0.44 0.464 0.492 0.517 0.528 ...
     0.533 0.534 0.531 0.524 0.51 0.50 0.499 0.468 0.38 0.36 0.339 ...
     0.318 0.291 0.251 0.244 0.239 0.239 0.244 0.247 0.224 0.195 0.174 ...
     0.172 0.18 0.194 0.213 0.243 0.271 0.289 0.334 0.344 0.382 0.401 ...
     0.4065 0.405 0.389 0.377 0.345 0.332 0.315 0.298 0.274 0.228 0.198 ...
     0.172 0.156 0.11 0.083 0.058 0.022 0.008473 0.003263 0.001256 ...
     0.0004837 0.0001862 7.165e-05 2.757e-05 1.061e-05 4.081e-06 ...
     1.57e-06 5.403e-07 1.829e-07 6.218e-08 2.113e-08 7.181e-09 ...
     2.44e-09 8.289e-10 2.816e-10 9.565e-11 3.249e-11 2.0e-11 2.0e-11 ...
     2.0e-11 2.0e-11 2.0e-11 2.0e-11 2.365e-11 2.669e-11 3.135e-11 ...
     4.14e-11 6.268e-11 9.239e-11 1.325e-10 1.956e-10 2.861e-10 ...
     4.172e-10 5.889e-10 8.036e-10 1.076e-09 1.409e-09 1.813e-09 ...
     2.289e-09 2.839e-09 3.461e-09 4.159e-09 4.93e-09 5.73e-09 ...
     6.89e-09 8.58e-09 1.04e-08 1.22e-08 1.43e-08 1.66e-08 1.89e-08 ...
     2.09e-08 2.4e-08 2.9e-08 3.44e-08 4.03e-08 4.3e-08 4.92e-08 ...
     5.87e-08 7.08e-08 8.58e-08 1.02e-07 1.18e-07 1.34e-07 1.4e-07 ...
     1.43e-07 1.45e-07 1.51e-07 1.83e-07 2.15e-07 2.65e-07 3.35e-07 ...
     3.92e-07 4.2e-07 4.44e-07 4.74e-07 5.11e-07 5.53e-07 6.02e-07 ...
     7.55e-07 9.26e-07 1.12e-06 1.33e-06 1.62e-06 2.0e-06 2.25e-06 ...
     2.33e-06 2.33e-06 2.17e-06 1.96e-06 1.81e-06 1.74e-06 1.73e-06 ...
     1.7e-06 1.76e-06 1.82e-06 2.04e-06 2.25e-06 2.29e-06 3.04e-06 ...
     3.84e-06 4.77e-06 5.76e-06 6.71e-06 8.66e-06 1.02e-05 1.13e-05 ...
     1.22e-05 1.29e-05 1.32e-05 1.35e-05 1.33e-05 1.32e-05 1.32e-05 ...
     1.31e-05 1.32e-05 1.32e-05 1.34e-05 1.39e-05 1.42e-05 1.48e-05 ...
     1.58e-05 1.74e-05 1.98e-05 3.442e-05 5.959e-05 0.0001028 ...
     0.0001516 0.000203 0.0002942 0.0003987 0.0004941 0.0005532 ...
     0.0005373 0.0005143 0.0004908 0.0004594 0.0003858 0.0003105 ...
     0.0002659 0.0002361 0.0002046 0.0001875 0.000165 0.0001522 ...
     0.0001411 0.0001302 0.000131 0.0001339 0.0001377 0.0001432 ...
     0.0001632 0.0002566 0.0004081 0.000706 0.001108 0.001442 ...
     0.001614 0.00164 0.001566 0.001458 0.001267 0.001023 0.0007586 ...
     0.0005255 0.0004025 0.0003235 0.0002707 0.0002228 0.0002037 ...
     0.0002026 0.0002035 0.0002078 0.0002171 0.0002538 0.0003138 ...
     0.0003858 0.0004591 0.0005187 0.0005605 0.0005956 0.0006259 ...
     0.000682 0.000753 0.0007685 0.0007647 0.0007473 0.0007392 ...
     0.0007437 0.0007543 0.0008059 0.001367 0.003508 0.01346 ...
     0.03245 0.04572 0.06287 0.08548 0.1198 0.169 0.221 0.276 0.312 ...
     0.347 0.388 0.438 0.493 0.554 0.612 0.625 0.593 0.539 0.491 0.438 ...
     0.372 0.30 0.238 0.193 0.158 0.121 0.103 0.0836 0.0668 0.05312 ...
     0.04286 0.03523 0.02887 0.02347 0.01921 0.01586 0.01326 0.0113 ...
     0.008146 0.006672 0.006966 0.008248 0.01112 0.01471 0.01867 ...
     0.02411 0.02656 0.0299 0.03179 0.0309 0.03007 0.02883 0.0194 ...
     0.01347 0.0124 0.0122 0.01302 0.0138 0.01683 0.02232 0.03256 ...
     0.03539 0.03883 0.0427 0.04643 0.05045 0.06439 0.0656 0.0636 ...
     0.06265 0.0617 0.06101 0.06031 0.05964 0.05899 0.0578 0.057 ...
     0.0568 0.05428 0.05161 0.0494 0.0484 0.046 0.0444 0.0429 0.04041 ...
     0.03911 0.03819 0.0376 0.03724 0.037 0.03677 0.03654 0.03664 ...
     0.03706 0.03789 0.04026 0.0445 0.05008 0.06461 0.075 0.088 0.108 ...
     0.134 0.168 0.204 0.248 0.28 0.341 0.379 0.409 0.422 0.422 0.403 ...
     0.389 0.374 0.354 0.335 0.315 0.294 0.271 0.246 0.198 0.164 0.152 ...
     0.142 0.128 0.125 0.123 0.116 0.107 0.079 0.07752 0.07455 0.072 ...
     0.076 0.075 0.067 0.055 0.045 0.029 0.0275 0.027 0.0273 0.0289 ...
     0.030 0.034 0.05122 0.08615 0.1348 0.1615 0.1895 0.2227 0.2528 ...
     0.2853 0.324 0.3945 0.4521 0.5535 0.6782 0.7684 0.8254 0.8458 ...
     0.8158 0.7414 0.6191 0.5353 0.478 0.4599 0.4468 0.4214 0.386 ...
     0.3508 0.3196 0.2981 0.2659 0.2569 0.2785 0.3076 0.3146 0.3471 ...
     0.3748 0.3902 0.4024 0.4115 0.4167 0.4167 0.4089 0.383 0.3543 ...
     0.334 0.2944 0.2679 0.2519 0.239 0.214 0.1913 0.1706 0.1151 ...
     0.06684 0.04282 0.02549 0.01405 0.005173 0.001337 0.0003574 ...
     0.0001839 0.0001294 0.0001058 9.675e-05 9.36e-05 9.613e-05 ...
     0.0001066 0.0001312 0.0001895 0.0003348 0.0006596];

 %% Extract desired properties

 if (WL < WLMIN) || (WL > WLMAX)
     error( 'requested wavelength is out of range (0.045 microns - 8 meters)')
 end

I = find(WL < WL0, 1, 'first');
X1 = log(WL0(I-1));
X2 = log(WL0(I));
Y1 = Re0(I-1);
Y2 = Re0(I);
X = log(WL);
Re = ((X-X1)*(Y2-Y1)/(X2-X1))+Y1;

Y1 = log(abs(Im0(I-1)));
Y2 = log(abs(Im0(I)));
Y = ((X-X1)*(Y2-Y1)/(X2-X1))+Y1;
Im = exp(Y);